2025-12-12 16:09:02.339 +02:00 [INF] User profile is available. Using 'C:\Users\yvann\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-12-12 16:09:02.539 +02:00 [INF] Appointment Reminder Service started at "2025-12-12T14:09:02.5359760Z"
2025-12-12 16:09:09.927 +02:00 [INF] Now listening on: https://localhost:7146
2025-12-12 16:09:09.930 +02:00 [INF] Now listening on: http://localhost:5291
2025-12-12 16:09:10.833 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-12-12 16:09:10.834 +02:00 [INF] Hosting environment: Development
2025-12-12 16:09:10.837 +02:00 [INF] Content root path: C:\Users\yvann\Downloads\Dotnet_Web_Api\MediPredict\MediPredict
2025-12-12 16:09:35.824 +02:00 [INF] Checking for reminders to send at "2025-12-12T14:09:35.8244040Z"
2025-12-12 16:09:39.429 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7146/swagger - null null
2025-12-12 16:09:39.563 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7146/swagger - null null
2025-12-12 16:09:39.787 +02:00 [ERR] Error occurred while sending appointment reminders
System.InvalidOperationException: The relationship from 'SymptomEntrySymptom.Symptom' to 'Symptom.SymptomEntries' with foreign key properties {'SymptomId' : Guid} cannot target the primary key {'Id' : int} because it is not compatible. Configure a principal key or a set of foreign key properties with compatible types for this relationship.
   at Microsoft.EntityFrameworkCore.Infrastructure.ModelValidator.ValidateNoShadowKeys(IModel model, IDiagnosticsLogger`1 logger)
   at Microsoft.EntityFrameworkCore.Infrastructure.ModelValidator.Validate(IModel model, IDiagnosticsLogger`1 logger)
   at Microsoft.EntityFrameworkCore.Infrastructure.RelationalModelValidator.Validate(IModel model, IDiagnosticsLogger`1 logger)
   at Microsoft.EntityFrameworkCore.SqlServer.Infrastructure.Internal.SqlServerModelValidator.Validate(IModel model, IDiagnosticsLogger`1 logger)
   at Microsoft.EntityFrameworkCore.Infrastructure.ModelRuntimeInitializer.Initialize(IModel model, Boolean designTime, IDiagnosticsLogger`1 validationLogger)
   at Microsoft.EntityFrameworkCore.Infrastructure.ModelSource.GetModel(DbContext context, ModelCreationDependencies modelCreationDependencies, Boolean designTime)
   at Microsoft.EntityFrameworkCore.Internal.DbContextServices.CreateModel(Boolean designTime)
   at Microsoft.EntityFrameworkCore.Internal.DbContextServices.get_Model()
   at Microsoft.EntityFrameworkCore.Infrastructure.EntityFrameworkServicesBuilder.<>c.<TryAddCoreServices>b__8_4(IServiceProvider p)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass2_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at Microsoft.EntityFrameworkCore.DbContext.get_DbContextDependencies()
   at Microsoft.EntityFrameworkCore.DbContext.get_ContextServices()
   at Microsoft.EntityFrameworkCore.DbContext.get_Model()
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.get_EntityType()
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.CheckState()
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.get_EntityQueryable()
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.System.Linq.IQueryable.get_Provider()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.Include[TEntity,TProperty](IQueryable`1 source, Expression`1 navigationPropertyPath)
   at MediPredict.Services.Implementations.AppointmentReminderService.SendScheduledRemindersAsync() in C:\Users\yvann\Downloads\Dotnet_Web_Api\MediPredict\MediPredict\Services\Implementations\AppointmentReminderService.cs:line 62
   at MediPredict.Services.Implementations.AppointmentReminderService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\yvann\Downloads\Dotnet_Web_Api\MediPredict\MediPredict\Services\Implementations\AppointmentReminderService.cs:line 38
2025-12-12 16:09:42.077 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7146/swagger - 301 0 null 2512.828ms
2025-12-12 16:09:42.077 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7146/swagger - 499 null null 2650.7877ms
2025-12-12 16:09:42.340 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7146/swagger/index.html - null null
2025-12-12 16:09:42.518 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7146/swagger/index.html - 200 null text/html;charset=utf-8 178.7819ms
2025-12-12 16:09:44.844 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7146/swagger/swagger-ui.css - null null
2025-12-12 16:09:44.845 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7146/swagger/swagger-ui-bundle.js - null null
2025-12-12 16:09:45.032 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7146/swagger/swagger-ui-standalone-preset.js - null null
2025-12-12 16:09:45.032 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7146/_framework/aspnetcore-browser-refresh.js - null null
2025-12-12 16:09:45.033 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7146/_vs/browserLink - null null
2025-12-12 16:09:45.051 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7146/_framework/aspnetcore-browser-refresh.js - 200 16507 application/javascript; charset=utf-8 18.331ms
2025-12-12 16:09:45.088 +02:00 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2025-12-12 16:09:45.092 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7146/swagger/swagger-ui.css - 200 152034 text/css 247.9804ms
2025-12-12 16:09:45.487 +02:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2025-12-12 16:09:45.494 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7146/swagger/swagger-ui-standalone-preset.js - 200 230280 text/javascript 461.6126ms
2025-12-12 16:09:45.725 +02:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2025-12-12 16:09:45.734 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7146/swagger/swagger-ui-bundle.js - 200 1456926 text/javascript 889.3641ms
2025-12-12 16:09:47.522 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7146/_vs/browserLink - 200 null text/javascript; charset=UTF-8 2489.5046ms
2025-12-12 16:09:48.660 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7146/swagger/v1/swagger.json - null null
2025-12-12 16:09:48.660 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7146/swagger/favicon-32x32.png - null null
2025-12-12 16:09:48.680 +02:00 [INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
2025-12-12 16:09:48.686 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7146/swagger/favicon-32x32.png - 200 628 image/png 25.3814ms
2025-12-12 16:09:48.738 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7146/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 77.452ms
2025-12-12 20:05:36.633 +02:00 [INF] Executed DbCommand (155ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-12 20:05:37.255 +02:00 [INF] Executed DbCommand (173ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-12-12 20:05:37.260 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-12 20:05:37.261 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-12-12 20:05:38.071 +02:00 [INF] Executed DbCommand (717ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-12-12 20:05:38.102 +02:00 [INF] Applying migration '20251212180301_ModernizeDatabase'.
2025-12-12 20:08:19.509 +02:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-12 20:08:23.133 +02:00 [INF] Executed DbCommand (3,313ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [MediPredictDB] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
END;
2025-12-12 20:08:28.272 +02:00 [INF] Executed DbCommand (5,138ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
DROP DATABASE [MediPredictDB];
2025-12-12 20:08:40.014 +02:00 [INF] Executed DbCommand (3,630ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [MediPredictDB];
2025-12-12 20:08:40.372 +02:00 [INF] Executed DbCommand (294ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [MediPredictDB] SET READ_COMMITTED_SNAPSHOT ON;
END;
2025-12-12 20:08:40.440 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-12 20:08:40.734 +02:00 [INF] Executed DbCommand (206ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2025-12-12 20:08:40.737 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-12 20:08:40.767 +02:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-12-12 20:08:40.783 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-12-12 20:08:40.813 +02:00 [INF] Applying migration '20251128122225_InitialCreate'.
2025-12-12 20:08:41.059 +02:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AIPredictions] (
    [Id] int NOT NULL IDENTITY,
    [SymptomEntryId] int NOT NULL,
    [DiseaseId] int NOT NULL,
    [Probability] decimal(18,2) NOT NULL,
    [ConfidenceLevel] decimal(18,2) NULL,
    [Recommendations] nvarchar(max) NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_AIPredictions] PRIMARY KEY ([Id])
);
2025-12-12 20:08:41.063 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Appointments] (
    [Id] int NOT NULL IDENTITY,
    [PatientId] int NOT NULL,
    [DoctorId] int NOT NULL,
    [ConsultationRequestId] int NULL,
    [ScheduledDate] datetime2 NOT NULL,
    [DurationMinutes] int NOT NULL,
    [Status] nvarchar(20) NOT NULL,
    [Notes] nvarchar(500) NULL,
    [Diagnosis] nvarchar(max) NULL,
    [TreatmentPlan] nvarchar(max) NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_Appointments] PRIMARY KEY ([Id])
);
2025-12-12 20:08:41.066 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Diseases] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(200) NOT NULL,
    [Description] nvarchar(max) NULL,
    [SymptomsDescription] nvarchar(max) NULL,
    [RecommendedAction] nvarchar(max) NULL,
    [Precautions] nvarchar(max) NULL,
    [ProbabilityScore] decimal(18,2) NULL,
    [IsActive] bit NOT NULL,
    CONSTRAINT [PK_Diseases] PRIMARY KEY ([Id])
);
2025-12-12 20:08:41.069 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [SymptomEntries] (
    [Id] int NOT NULL IDENTITY,
    [PatientId] int NOT NULL,
    [SymptomsJson] nvarchar(max) NOT NULL,
    [SeverityLevel] int NOT NULL,
    [Description] nvarchar(500) NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_SymptomEntries] PRIMARY KEY ([Id])
);
2025-12-12 20:08:41.071 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Symptoms] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(200) NOT NULL,
    [Description] nvarchar(500) NULL,
    [Category] nvarchar(100) NULL,
    [SeverityLevel] int NOT NULL,
    [IsActive] bit NOT NULL,
    CONSTRAINT [PK_Symptoms] PRIMARY KEY ([Id])
);
2025-12-12 20:08:41.074 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Users] (
    [Id] nvarchar(450) NOT NULL,
    [UserName] nvarchar(256) NOT NULL,
    [PasswordHash] nvarchar(max) NOT NULL,
    [Role] nvarchar(20) NOT NULL,
    [IsActive] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [LastLogin] datetime2 NULL,
    CONSTRAINT [PK_Users] PRIMARY KEY ([Id])
);
2025-12-12 20:08:41.096 +02:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Doctors] (
    [Id] int NOT NULL IDENTITY,
    [UserId] nvarchar(450) NOT NULL,
    [FirstName] nvarchar(100) NOT NULL,
    [LastName] nvarchar(100) NOT NULL,
    [DateOfBirth] datetime2 NOT NULL,
    [Gender] nvarchar(10) NOT NULL,
    [PhoneNumber] nvarchar(20) NULL,
    [Specialization] nvarchar(100) NOT NULL,
    [Qualifications] nvarchar(max) NOT NULL,
    [Experience] int NOT NULL,
    [LicenseNumber] nvarchar(50) NOT NULL,
    [IsVerified] bit NOT NULL,
    [ConsultationFee] decimal(18,2) NOT NULL,
    [Bio] nvarchar(max) NULL,
    [AvailableDays] nvarchar(100) NULL,
    [AvailableTimeStart] time NULL,
    [AvailableTimeEnd] time NULL,
    [Address] nvarchar(500) NULL,
    [ProfilePicture] nvarchar(500) NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_Doctors] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Doctors_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-12-12 20:08:41.099 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Patients] (
    [Id] int NOT NULL IDENTITY,
    [UserId] nvarchar(450) NOT NULL,
    [FirstName] nvarchar(100) NOT NULL,
    [LastName] nvarchar(100) NOT NULL,
    [DateOfBirth] datetime2 NOT NULL,
    [Gender] nvarchar(10) NOT NULL,
    [PhoneNumber] nvarchar(20) NULL,
    [BloodGroup] nvarchar(5) NULL,
    [Allergies] nvarchar(max) NULL,
    [MedicalHistory] nvarchar(max) NULL,
    [EmergencyContact] nvarchar(100) NULL,
    [EmergencyPhone] nvarchar(20) NULL,
    [Address] nvarchar(500) NULL,
    [ProfilePicture] nvarchar(500) NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_Patients] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Patients_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-12-12 20:08:41.276 +02:00 [INF] Executed DbCommand (75ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Doctors_IsVerified] ON [Doctors] ([IsVerified]);
2025-12-12 20:08:41.278 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Doctors_LicenseNumber] ON [Doctors] ([LicenseNumber]);
2025-12-12 20:08:41.280 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Doctors_Specialization] ON [Doctors] ([Specialization]);
2025-12-12 20:08:41.283 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Doctors_UserId] ON [Doctors] ([UserId]);
2025-12-12 20:08:41.284 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Patients_UserId] ON [Patients] ([UserId]);
2025-12-12 20:08:41.286 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Users_UserName] ON [Users] ([UserName]);
2025-12-12 20:08:41.394 +02:00 [INF] Executed DbCommand (108ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251128122225_InitialCreate', N'8.0.20');
2025-12-12 20:08:41.404 +02:00 [INF] Applying migration '20251129093154_CustomAuthSystem'.
2025-12-12 20:08:41.610 +02:00 [INF] Executed DbCommand (166ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Doctors] DROP CONSTRAINT [FK_Doctors_Users_UserId];
2025-12-12 20:08:41.620 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Patients] DROP CONSTRAINT [FK_Patients_Users_UserId];
2025-12-12 20:08:41.624 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP TABLE [Users];
2025-12-12 20:08:43.066 +02:00 [INF] Executed DbCommand (1,442ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var0 sysname;
SELECT @var0 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Patients]') AND [c].[name] = N'DateOfBirth');
IF @var0 IS NOT NULL EXEC(N'ALTER TABLE [Patients] DROP CONSTRAINT [' + @var0 + '];');
ALTER TABLE [Patients] DROP COLUMN [DateOfBirth];
2025-12-12 20:08:43.101 +02:00 [INF] Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var1 sysname;
SELECT @var1 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Patients]') AND [c].[name] = N'FirstName');
IF @var1 IS NOT NULL EXEC(N'ALTER TABLE [Patients] DROP CONSTRAINT [' + @var1 + '];');
ALTER TABLE [Patients] DROP COLUMN [FirstName];
2025-12-12 20:08:43.138 +02:00 [INF] Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var2 sysname;
SELECT @var2 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Patients]') AND [c].[name] = N'Gender');
IF @var2 IS NOT NULL EXEC(N'ALTER TABLE [Patients] DROP CONSTRAINT [' + @var2 + '];');
ALTER TABLE [Patients] DROP COLUMN [Gender];
2025-12-12 20:08:43.167 +02:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var3 sysname;
SELECT @var3 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Patients]') AND [c].[name] = N'LastName');
IF @var3 IS NOT NULL EXEC(N'ALTER TABLE [Patients] DROP CONSTRAINT [' + @var3 + '];');
ALTER TABLE [Patients] DROP COLUMN [LastName];
2025-12-12 20:08:44.874 +02:00 [INF] Executed DbCommand (377ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var4 sysname;
SELECT @var4 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Patients]') AND [c].[name] = N'PhoneNumber');
IF @var4 IS NOT NULL EXEC(N'ALTER TABLE [Patients] DROP CONSTRAINT [' + @var4 + '];');
ALTER TABLE [Patients] DROP COLUMN [PhoneNumber];
2025-12-12 20:08:44.960 +02:00 [INF] Executed DbCommand (86ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var5 sysname;
SELECT @var5 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Doctors]') AND [c].[name] = N'DateOfBirth');
IF @var5 IS NOT NULL EXEC(N'ALTER TABLE [Doctors] DROP CONSTRAINT [' + @var5 + '];');
ALTER TABLE [Doctors] DROP COLUMN [DateOfBirth];
2025-12-12 20:08:45.014 +02:00 [INF] Executed DbCommand (53ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var6 sysname;
SELECT @var6 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Doctors]') AND [c].[name] = N'FirstName');
IF @var6 IS NOT NULL EXEC(N'ALTER TABLE [Doctors] DROP CONSTRAINT [' + @var6 + '];');
ALTER TABLE [Doctors] DROP COLUMN [FirstName];
2025-12-12 20:08:45.043 +02:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var7 sysname;
SELECT @var7 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Doctors]') AND [c].[name] = N'Gender');
IF @var7 IS NOT NULL EXEC(N'ALTER TABLE [Doctors] DROP CONSTRAINT [' + @var7 + '];');
ALTER TABLE [Doctors] DROP COLUMN [Gender];
2025-12-12 20:08:45.068 +02:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var8 sysname;
SELECT @var8 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Doctors]') AND [c].[name] = N'LastName');
IF @var8 IS NOT NULL EXEC(N'ALTER TABLE [Doctors] DROP CONSTRAINT [' + @var8 + '];');
ALTER TABLE [Doctors] DROP COLUMN [LastName];
2025-12-12 20:08:45.095 +02:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var9 sysname;
SELECT @var9 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Doctors]') AND [c].[name] = N'PhoneNumber');
IF @var9 IS NOT NULL EXEC(N'ALTER TABLE [Doctors] DROP CONSTRAINT [' + @var9 + '];');
ALTER TABLE [Doctors] DROP COLUMN [PhoneNumber];
2025-12-12 20:08:45.258 +02:00 [INF] Executed DbCommand (162ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var10 sysname;
SELECT @var10 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Diseases]') AND [c].[name] = N'ProbabilityScore');
IF @var10 IS NOT NULL EXEC(N'ALTER TABLE [Diseases] DROP CONSTRAINT [' + @var10 + '];');
ALTER TABLE [Diseases] ALTER COLUMN [ProbabilityScore] decimal(5,2) NULL;
2025-12-12 20:08:46.646 +02:00 [INF] Executed DbCommand (134ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var11 sysname;
SELECT @var11 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[AIPredictions]') AND [c].[name] = N'Probability');
IF @var11 IS NOT NULL EXEC(N'ALTER TABLE [AIPredictions] DROP CONSTRAINT [' + @var11 + '];');
ALTER TABLE [AIPredictions] ALTER COLUMN [Probability] decimal(5,2) NOT NULL;
2025-12-12 20:08:46.690 +02:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var12 sysname;
SELECT @var12 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[AIPredictions]') AND [c].[name] = N'ConfidenceLevel');
IF @var12 IS NOT NULL EXEC(N'ALTER TABLE [AIPredictions] DROP CONSTRAINT [' + @var12 + '];');
ALTER TABLE [AIPredictions] ALTER COLUMN [ConfidenceLevel] decimal(5,2) NULL;
2025-12-12 20:08:46.761 +02:00 [INF] Executed DbCommand (71ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUsers] (
    [Id] nvarchar(450) NOT NULL,
    [UserName] nvarchar(256) NOT NULL,
    [Email] nvarchar(256) NOT NULL,
    [PasswordHash] nvarchar(max) NOT NULL,
    [FirstName] nvarchar(50) NOT NULL,
    [LastName] nvarchar(50) NOT NULL,
    [DateOfBirth] datetime2 NOT NULL,
    [Gender] nvarchar(10) NOT NULL,
    [Role] nvarchar(20) NOT NULL,
    [PhoneNumber] nvarchar(20) NULL,
    [IsActive] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [LastLoginAt] datetime2 NULL,
    CONSTRAINT [PK_AspNetUsers] PRIMARY KEY ([Id])
);
2025-12-12 20:08:46.763 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_AspNetUsers_Email] ON [AspNetUsers] ([Email]);
2025-12-12 20:08:46.764 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUsers_Role] ON [AspNetUsers] ([Role]);
2025-12-12 20:08:46.783 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Doctors] ADD CONSTRAINT [FK_Doctors_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE;
2025-12-12 20:08:46.785 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Patients] ADD CONSTRAINT [FK_Patients_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE;
2025-12-12 20:08:46.849 +02:00 [INF] Executed DbCommand (64ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251129093154_CustomAuthSystem', N'8.0.20');
2025-12-12 20:08:46.861 +02:00 [INF] Applying migration '20251129160853_AddDateOfBirthGenderAndNavigationProperties'.
2025-12-12 20:08:47.007 +02:00 [INF] Executed DbCommand (112ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Patients] ADD [DateOfBirth] datetime2 NOT NULL DEFAULT '0001-01-01T00:00:00.0000000';
2025-12-12 20:08:47.010 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Patients] ADD [Gender] nvarchar(20) NOT NULL DEFAULT N'';
2025-12-12 20:08:47.014 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Appointments] ADD [AppointmentDate] datetime2 NOT NULL DEFAULT '0001-01-01T00:00:00.0000000';
2025-12-12 20:08:47.016 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Appointments] ADD [ConfirmationNumber] nvarchar(50) NOT NULL DEFAULT N'';
2025-12-12 20:08:47.018 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Appointments] ADD [ReasonForVisit] nvarchar(500) NULL;
2025-12-12 20:08:47.037 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_SymptomEntries_PatientId] ON [SymptomEntries] ([PatientId]);
2025-12-12 20:08:48.451 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Appointments_DoctorId] ON [Appointments] ([DoctorId]);
2025-12-12 20:08:48.453 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Appointments_PatientId] ON [Appointments] ([PatientId]);
2025-12-12 20:08:48.457 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AIPredictions_DiseaseId] ON [AIPredictions] ([DiseaseId]);
2025-12-12 20:08:48.458 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AIPredictions_SymptomEntryId] ON [AIPredictions] ([SymptomEntryId]);
2025-12-12 20:08:48.460 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [AIPredictions] ADD CONSTRAINT [FK_AIPredictions_Diseases_DiseaseId] FOREIGN KEY ([DiseaseId]) REFERENCES [Diseases] ([Id]) ON DELETE NO ACTION;
2025-12-12 20:08:48.462 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [AIPredictions] ADD CONSTRAINT [FK_AIPredictions_SymptomEntries_SymptomEntryId] FOREIGN KEY ([SymptomEntryId]) REFERENCES [SymptomEntries] ([Id]) ON DELETE CASCADE;
2025-12-12 20:08:48.466 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Appointments] ADD CONSTRAINT [FK_Appointments_Doctors_DoctorId] FOREIGN KEY ([DoctorId]) REFERENCES [Doctors] ([Id]) ON DELETE NO ACTION;
2025-12-12 20:08:48.468 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Appointments] ADD CONSTRAINT [FK_Appointments_Patients_PatientId] FOREIGN KEY ([PatientId]) REFERENCES [Patients] ([Id]) ON DELETE NO ACTION;
2025-12-12 20:08:48.471 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [SymptomEntries] ADD CONSTRAINT [FK_SymptomEntries_Patients_PatientId] FOREIGN KEY ([PatientId]) REFERENCES [Patients] ([Id]) ON DELETE CASCADE;
2025-12-12 20:08:48.478 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251129160853_AddDateOfBirthGenderAndNavigationProperties', N'8.0.20');
2025-12-12 20:08:48.480 +02:00 [INF] Applying migration '20251129222924_AddConsultationAndPrescriptionTables'.
2025-12-12 20:08:48.536 +02:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ConsultationRecords] (
    [Id] int NOT NULL IDENTITY,
    [AppointmentId] int NOT NULL,
    [PatientId] int NOT NULL,
    [DoctorId] int NOT NULL,
    [AIPredictionId] int NULL,
    [OfficialDiagnosis] nvarchar(500) NOT NULL,
    [AIDiagnosisConfirmed] bit NOT NULL,
    [ConsultationNotes] nvarchar(2000) NULL,
    [TreatmentPlan] nvarchar(2000) NULL,
    [LabTestsOrdered] nvarchar(1000) NULL,
    [ConsultationDate] datetime2 NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NULL,
    CONSTRAINT [PK_ConsultationRecords] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ConsultationRecords_AIPredictions_AIPredictionId] FOREIGN KEY ([AIPredictionId]) REFERENCES [AIPredictions] ([Id]) ON DELETE SET NULL,
    CONSTRAINT [FK_ConsultationRecords_Appointments_AppointmentId] FOREIGN KEY ([AppointmentId]) REFERENCES [Appointments] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_ConsultationRecords_Doctors_DoctorId] FOREIGN KEY ([DoctorId]) REFERENCES [Doctors] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_ConsultationRecords_Patients_PatientId] FOREIGN KEY ([PatientId]) REFERENCES [Patients] ([Id]) ON DELETE NO ACTION
);
2025-12-12 20:08:48.538 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Prescriptions] (
    [Id] int NOT NULL IDENTITY,
    [ConsultationRecordId] int NOT NULL,
    [DrugName] nvarchar(200) NOT NULL,
    [Dosage] nvarchar(100) NOT NULL,
    [Frequency] nvarchar(100) NOT NULL,
    [Duration] nvarchar(100) NOT NULL,
    [Instructions] nvarchar(500) NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_Prescriptions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Prescriptions_ConsultationRecords_ConsultationRecordId] FOREIGN KEY ([ConsultationRecordId]) REFERENCES [ConsultationRecords] ([Id]) ON DELETE CASCADE
);
2025-12-12 20:08:50.306 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ConsultationRecords_AIPredictionId] ON [ConsultationRecords] ([AIPredictionId]);
2025-12-12 20:08:50.307 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ConsultationRecords_AppointmentId] ON [ConsultationRecords] ([AppointmentId]);
2025-12-12 20:08:50.308 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ConsultationRecords_DoctorId] ON [ConsultationRecords] ([DoctorId]);
2025-12-12 20:08:50.310 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ConsultationRecords_PatientId] ON [ConsultationRecords] ([PatientId]);
2025-12-12 20:08:50.311 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Prescriptions_ConsultationRecordId] ON [Prescriptions] ([ConsultationRecordId]);
2025-12-12 20:08:50.322 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251129222924_AddConsultationAndPrescriptionTables', N'8.0.20');
2025-12-12 20:08:50.323 +02:00 [INF] Applying migration '20251129233125_AddSymptomEntryLinkToAppointment'.
2025-12-12 20:08:50.346 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Appointments] ADD [SymptomEntryId] int NULL;
2025-12-12 20:08:50.348 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Appointments_SymptomEntryId] ON [Appointments] ([SymptomEntryId]);
2025-12-12 20:08:50.354 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Appointments] ADD CONSTRAINT [FK_Appointments_SymptomEntries_SymptomEntryId] FOREIGN KEY ([SymptomEntryId]) REFERENCES [SymptomEntries] ([Id]) ON DELETE NO ACTION;
2025-12-12 20:08:50.355 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251129233125_AddSymptomEntryLinkToAppointment', N'8.0.20');
2025-12-12 20:08:50.356 +02:00 [INF] Applying migration '20251209165533_AddProfilePictureAndConsultationEnhancements'.
2025-12-12 20:08:50.379 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [ConsultationRecords] ADD [FollowUpDate] datetime2 NULL;
2025-12-12 20:08:50.380 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [ConsultationRecords] ADD [FollowUpInstructions] nvarchar(1000) NULL;
2025-12-12 20:08:50.387 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [ConsultationRecords] ADD [FollowUpRequired] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-12-12 20:08:50.388 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [ConsultationRecords] ADD [LabReports] nvarchar(2000) NULL;
2025-12-12 20:08:50.389 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [ConsultationRecords] ADD [PatientRecordNotes] nvarchar(3000) NULL;
2025-12-12 20:08:50.391 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [ConsultationRecords] ADD [SpecialistReferrals] nvarchar(1000) NULL;
2025-12-12 20:08:50.393 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [AspNetUsers] ADD [ProfilePicture] nvarchar(500) NULL;
2025-12-12 20:08:50.393 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251209165533_AddProfilePictureAndConsultationEnhancements', N'8.0.20');
2025-12-12 20:08:51.888 +02:00 [INF] Applying migration '20251210215944_AddAppointmentEmailTrackingFields'.
2025-12-12 20:08:51.919 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Appointments] ADD [CancellationEmailSent] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-12-12 20:08:51.922 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Appointments] ADD [CancellationEmailSentAt] datetime2 NULL;
2025-12-12 20:08:51.925 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Appointments] ADD [ConfirmationEmailSent] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-12-12 20:08:51.926 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Appointments] ADD [ConfirmationEmailSentAt] datetime2 NULL;
2025-12-12 20:08:51.928 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Appointments] ADD [OneDayReminderSent] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-12-12 20:08:51.929 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Appointments] ADD [OneDayReminderSentAt] datetime2 NULL;
2025-12-12 20:08:51.931 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Appointments] ADD [SameDayReminderSent] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-12-12 20:08:51.934 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Appointments] ADD [SameDayReminderSentAt] datetime2 NULL;
2025-12-12 20:08:51.938 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Appointments] ADD [ThreeDayReminderSent] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-12-12 20:08:51.939 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Appointments] ADD [ThreeDayReminderSentAt] datetime2 NULL;
2025-12-12 20:08:51.941 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Appointments] ADD [ThreeWeekReminderSent] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-12-12 20:08:51.942 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Appointments] ADD [ThreeWeekReminderSentAt] datetime2 NULL;
2025-12-12 20:08:51.943 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251210215944_AddAppointmentEmailTrackingFields', N'8.0.20');
2025-12-12 20:08:51.944 +02:00 [INF] Applying migration '20251212180301_ModernizeDatabase'.
2025-12-12 20:13:56.508 +02:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-12 20:13:56.682 +02:00 [INF] Executed DbCommand (65ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [MediPredictDB] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
END;
2025-12-12 20:13:56.989 +02:00 [INF] Executed DbCommand (306ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
DROP DATABASE [MediPredictDB];
2025-12-12 20:15:06.814 +02:00 [INF] Executed DbCommand (3,295ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [MediPredictDB];
2025-12-12 20:15:07.501 +02:00 [INF] Executed DbCommand (621ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [MediPredictDB] SET READ_COMMITTED_SNAPSHOT ON;
END;
2025-12-12 20:15:07.531 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-12 20:15:07.641 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2025-12-12 20:15:07.642 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-12 20:15:07.665 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-12-12 20:15:07.678 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-12-12 20:15:07.703 +02:00 [INF] Applying migration '20251212181427_InitialCreate'.
2025-12-12 20:15:07.869 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUsers] (
    [Id] uniqueidentifier NOT NULL,
    [UserName] nvarchar(256) NOT NULL,
    [PasswordHash] nvarchar(max) NOT NULL,
    [Role] int NOT NULL,
    [IsActive] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [LastLoginAt] datetime2 NULL,
    [FirstName] nvarchar(50) NOT NULL,
    [LastName] nvarchar(50) NOT NULL,
    [Email] nvarchar(256) NOT NULL,
    [DateOfBirth] datetime2 NOT NULL,
    [Gender] int NOT NULL,
    [PhoneNumber] nvarchar(20) NULL,
    [Address] nvarchar(500) NULL,
    [ProfilePicture] nvarchar(500) NULL,
    CONSTRAINT [PK_AspNetUsers] PRIMARY KEY ([Id])
);
2025-12-12 20:15:07.872 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Diseases] (
    [Id] uniqueidentifier NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [Description] nvarchar(max) NULL,
    [SymptomsDescription] nvarchar(max) NULL,
    [RecommendedAction] nvarchar(max) NULL,
    [Precautions] nvarchar(max) NULL,
    [ProbabilityScore] decimal(5,2) NULL,
    [IsActive] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_Diseases] PRIMARY KEY ([Id])
);
2025-12-12 20:15:07.875 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [HealthcareOrganizations] (
    [Id] uniqueidentifier NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [Type] nvarchar(100) NOT NULL,
    [Address] nvarchar(500) NULL,
    [City] nvarchar(100) NULL,
    [State] nvarchar(50) NULL,
    [PostalCode] nvarchar(20) NULL,
    [Country] nvarchar(50) NULL,
    [Phone] nvarchar(20) NULL,
    [Email] nvarchar(256) NULL,
    [Website] nvarchar(200) NULL,
    [Description] nvarchar(max) NULL,
    [IsActive] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_HealthcareOrganizations] PRIMARY KEY ([Id])
);
2025-12-12 20:15:07.878 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Symptoms] (
    [Id] uniqueidentifier NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [Description] nvarchar(500) NULL,
    [Category] nvarchar(100) NULL,
    [SeverityLevel] int NOT NULL,
    [IsActive] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_Symptoms] PRIMARY KEY ([Id])
);
2025-12-12 20:15:07.881 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Doctors] (
    [Id] uniqueidentifier NOT NULL,
    [UserId] uniqueidentifier NOT NULL,
    [Specialization] nvarchar(100) NOT NULL,
    [Qualifications] nvarchar(max) NOT NULL,
    [Experience] int NOT NULL,
    [LicenseNumber] nvarchar(50) NOT NULL,
    [IsVerified] bit NOT NULL,
    [ConsultationFee] decimal(18,2) NOT NULL,
    [Bio] nvarchar(max) NULL,
    [AvailableDays] nvarchar(100) NULL,
    [AvailableTimeStart] time NULL,
    [AvailableTimeEnd] time NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_Doctors] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Doctors_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2025-12-12 20:15:07.884 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Patients] (
    [Id] uniqueidentifier NOT NULL,
    [UserId] uniqueidentifier NOT NULL,
    [BloodGroup] nvarchar(5) NULL,
    [Allergies] nvarchar(max) NULL,
    [MedicalHistory] nvarchar(max) NULL,
    [EmergencyContact] nvarchar(100) NULL,
    [EmergencyPhone] nvarchar(20) NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_Patients] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Patients_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2025-12-12 20:15:07.894 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [DoctorAffiliations] (
    [Id] uniqueidentifier NOT NULL,
    [DoctorId] uniqueidentifier NOT NULL,
    [OrganizationId] uniqueidentifier NOT NULL,
    [Position] nvarchar(100) NULL,
    [Department] nvarchar(50) NULL,
    [StartDate] datetime2 NOT NULL,
    [EndDate] datetime2 NULL,
    [IsPrimary] bit NOT NULL,
    [IsActive] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_DoctorAffiliations] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_DoctorAffiliations_Doctors_DoctorId] FOREIGN KEY ([DoctorId]) REFERENCES [Doctors] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_DoctorAffiliations_HealthcareOrganizations_OrganizationId] FOREIGN KEY ([OrganizationId]) REFERENCES [HealthcareOrganizations] ([Id]) ON DELETE NO ACTION
);
2025-12-12 20:15:07.898 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [SymptomEntries] (
    [Id] uniqueidentifier NOT NULL,
    [PatientId] uniqueidentifier NOT NULL,
    [SeverityLevel] int NOT NULL,
    [Description] nvarchar(500) NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_SymptomEntries] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_SymptomEntries_Patients_PatientId] FOREIGN KEY ([PatientId]) REFERENCES [Patients] ([Id]) ON DELETE CASCADE
);
2025-12-12 20:15:07.938 +02:00 [INF] Executed DbCommand (40ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AIPredictions] (
    [Id] uniqueidentifier NOT NULL,
    [SymptomEntryId] uniqueidentifier NOT NULL,
    [DiseaseId] uniqueidentifier NOT NULL,
    [Probability] decimal(5,2) NOT NULL,
    [ConfidenceLevel] decimal(5,2) NULL,
    [Recommendations] nvarchar(max) NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_AIPredictions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AIPredictions_Diseases_DiseaseId] FOREIGN KEY ([DiseaseId]) REFERENCES [Diseases] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_AIPredictions_SymptomEntries_SymptomEntryId] FOREIGN KEY ([SymptomEntryId]) REFERENCES [SymptomEntries] ([Id]) ON DELETE CASCADE
);
2025-12-12 20:15:07.942 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Appointments] (
    [Id] uniqueidentifier NOT NULL,
    [PatientId] uniqueidentifier NOT NULL,
    [DoctorId] uniqueidentifier NOT NULL,
    [SymptomEntryId] uniqueidentifier NULL,
    [ScheduledDate] datetime2 NOT NULL,
    [AppointmentDate] datetime2 NOT NULL,
    [DurationMinutes] int NOT NULL,
    [Status] int NOT NULL,
    [Notes] nvarchar(500) NULL,
    [Diagnosis] nvarchar(max) NULL,
    [TreatmentPlan] nvarchar(max) NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NOT NULL,
    [ConfirmationNumber] nvarchar(50) NOT NULL,
    [ReasonForVisit] nvarchar(500) NULL,
    CONSTRAINT [PK_Appointments] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Appointments_Doctors_DoctorId] FOREIGN KEY ([DoctorId]) REFERENCES [Doctors] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Appointments_Patients_PatientId] FOREIGN KEY ([PatientId]) REFERENCES [Patients] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Appointments_SymptomEntries_SymptomEntryId] FOREIGN KEY ([SymptomEntryId]) REFERENCES [SymptomEntries] ([Id]) ON DELETE NO ACTION
);
2025-12-12 20:15:07.945 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [SymptomEntrySymptoms] (
    [Id] uniqueidentifier NOT NULL,
    [SymptomEntryId] uniqueidentifier NOT NULL,
    [SymptomId] uniqueidentifier NOT NULL,
    [SeverityLevel] int NOT NULL,
    [AdditionalNotes] nvarchar(500) NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_SymptomEntrySymptoms] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_SymptomEntrySymptoms_SymptomEntries_SymptomEntryId] FOREIGN KEY ([SymptomEntryId]) REFERENCES [SymptomEntries] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_SymptomEntrySymptoms_Symptoms_SymptomId] FOREIGN KEY ([SymptomId]) REFERENCES [Symptoms] ([Id]) ON DELETE NO ACTION
);
2025-12-12 20:15:11.072 +02:00 [INF] Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ConsultationRecords] (
    [Id] uniqueidentifier NOT NULL,
    [AppointmentId] uniqueidentifier NOT NULL,
    [PatientId] uniqueidentifier NOT NULL,
    [DoctorId] uniqueidentifier NOT NULL,
    [AIPredictionId] uniqueidentifier NULL,
    [OfficialDiagnosis] nvarchar(500) NOT NULL,
    [AIDiagnosisConfirmed] bit NOT NULL,
    [ConsultationNotes] nvarchar(2000) NULL,
    [TreatmentPlan] nvarchar(2000) NULL,
    [LabTestsOrdered] nvarchar(1000) NULL,
    [LabReports] nvarchar(2000) NULL,
    [SpecialistReferrals] nvarchar(1000) NULL,
    [PatientRecordNotes] nvarchar(3000) NULL,
    [FollowUpRequired] bit NOT NULL,
    [FollowUpDate] datetime2 NULL,
    [FollowUpInstructions] nvarchar(1000) NULL,
    [ConsultationDate] datetime2 NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NULL,
    CONSTRAINT [PK_ConsultationRecords] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ConsultationRecords_AIPredictions_AIPredictionId] FOREIGN KEY ([AIPredictionId]) REFERENCES [AIPredictions] ([Id]) ON DELETE SET NULL,
    CONSTRAINT [FK_ConsultationRecords_Appointments_AppointmentId] FOREIGN KEY ([AppointmentId]) REFERENCES [Appointments] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_ConsultationRecords_Doctors_DoctorId] FOREIGN KEY ([DoctorId]) REFERENCES [Doctors] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_ConsultationRecords_Patients_PatientId] FOREIGN KEY ([PatientId]) REFERENCES [Patients] ([Id]) ON DELETE NO ACTION
);
2025-12-12 20:15:11.088 +02:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [NotificationLogs] (
    [Id] uniqueidentifier NOT NULL,
    [Type] int NOT NULL,
    [UserId] uniqueidentifier NOT NULL,
    [AppointmentId] uniqueidentifier NULL,
    [ConsultationId] uniqueidentifier NULL,
    [RecipientEmail] nvarchar(256) NOT NULL,
    [Subject] nvarchar(500) NULL,
    [MessageBody] nvarchar(max) NULL,
    [IsSent] bit NOT NULL,
    [SentAt] datetime2 NULL,
    [ErrorMessage] nvarchar(500) NULL,
    [RetryCount] int NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_NotificationLogs] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_NotificationLogs_Appointments_AppointmentId] FOREIGN KEY ([AppointmentId]) REFERENCES [Appointments] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_NotificationLogs_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_NotificationLogs_ConsultationRecords_ConsultationId] FOREIGN KEY ([ConsultationId]) REFERENCES [ConsultationRecords] ([Id]) ON DELETE NO ACTION
);
2025-12-12 20:15:11.090 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Prescriptions] (
    [Id] uniqueidentifier NOT NULL,
    [ConsultationRecordId] uniqueidentifier NOT NULL,
    [DrugName] nvarchar(200) NOT NULL,
    [Dosage] nvarchar(100) NOT NULL,
    [Frequency] nvarchar(100) NOT NULL,
    [Duration] nvarchar(100) NOT NULL,
    [Instructions] nvarchar(500) NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_Prescriptions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Prescriptions_ConsultationRecords_ConsultationRecordId] FOREIGN KEY ([ConsultationRecordId]) REFERENCES [ConsultationRecords] ([Id]) ON DELETE CASCADE
);
2025-12-12 20:15:11.092 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AIPredictions_DiseaseId] ON [AIPredictions] ([DiseaseId]);
2025-12-12 20:15:11.094 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AIPredictions_SymptomEntryId] ON [AIPredictions] ([SymptomEntryId]);
2025-12-12 20:15:13.565 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Appointments_AppointmentDate] ON [Appointments] ([AppointmentDate]);
2025-12-12 20:15:13.567 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Appointments_ConfirmationNumber] ON [Appointments] ([ConfirmationNumber]);
2025-12-12 20:15:13.569 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Appointments_DoctorId] ON [Appointments] ([DoctorId]);
2025-12-12 20:15:13.570 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Appointments_PatientId] ON [Appointments] ([PatientId]);
2025-12-12 20:15:13.572 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Appointments_Status] ON [Appointments] ([Status]);
2025-12-12 20:15:13.573 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Appointments_SymptomEntryId] ON [Appointments] ([SymptomEntryId]);
2025-12-12 20:15:13.574 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_AspNetUsers_Email] ON [AspNetUsers] ([Email]);
2025-12-12 20:15:13.576 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUsers_IsActive] ON [AspNetUsers] ([IsActive]);
2025-12-12 20:15:13.578 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUsers_Role] ON [AspNetUsers] ([Role]);
2025-12-12 20:15:13.580 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ConsultationRecords_AIPredictionId] ON [ConsultationRecords] ([AIPredictionId]);
2025-12-12 20:15:13.582 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ConsultationRecords_AppointmentId] ON [ConsultationRecords] ([AppointmentId]);
2025-12-12 20:15:13.584 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ConsultationRecords_DoctorId] ON [ConsultationRecords] ([DoctorId]);
2025-12-12 20:15:13.585 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ConsultationRecords_PatientId] ON [ConsultationRecords] ([PatientId]);
2025-12-12 20:15:13.586 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Diseases_IsActive] ON [Diseases] ([IsActive]);
2025-12-12 20:15:13.588 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_DoctorAffiliations_DoctorId_OrganizationId] ON [DoctorAffiliations] ([DoctorId], [OrganizationId]);
2025-12-12 20:15:13.589 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_DoctorAffiliations_OrganizationId] ON [DoctorAffiliations] ([OrganizationId]);
2025-12-12 20:15:13.590 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Doctors_IsVerified] ON [Doctors] ([IsVerified]);
2025-12-12 20:15:13.591 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Doctors_LicenseNumber] ON [Doctors] ([LicenseNumber]);
2025-12-12 20:15:13.593 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Doctors_Specialization] ON [Doctors] ([Specialization]);
2025-12-12 20:15:13.594 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Doctors_UserId] ON [Doctors] ([UserId]);
2025-12-12 20:15:13.596 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_HealthcareOrganizations_IsActive] ON [HealthcareOrganizations] ([IsActive]);
2025-12-12 20:15:13.598 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_HealthcareOrganizations_Name] ON [HealthcareOrganizations] ([Name]);
2025-12-12 20:15:13.600 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_NotificationLogs_AppointmentId] ON [NotificationLogs] ([AppointmentId]);
2025-12-12 20:15:15.658 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_NotificationLogs_ConsultationId] ON [NotificationLogs] ([ConsultationId]);
2025-12-12 20:15:15.660 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_NotificationLogs_IsSent_CreatedAt] ON [NotificationLogs] ([IsSent], [CreatedAt]);
2025-12-12 20:15:15.662 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_NotificationLogs_UserId_Type_SentAt] ON [NotificationLogs] ([UserId], [Type], [SentAt]);
2025-12-12 20:15:15.663 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Patients_UserId] ON [Patients] ([UserId]);
2025-12-12 20:15:15.664 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Prescriptions_ConsultationRecordId] ON [Prescriptions] ([ConsultationRecordId]);
2025-12-12 20:15:15.665 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_SymptomEntries_PatientId] ON [SymptomEntries] ([PatientId]);
2025-12-12 20:15:15.667 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_SymptomEntrySymptoms_SymptomEntryId_SymptomId] ON [SymptomEntrySymptoms] ([SymptomEntryId], [SymptomId]);
2025-12-12 20:15:15.668 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_SymptomEntrySymptoms_SymptomId] ON [SymptomEntrySymptoms] ([SymptomId]);
2025-12-12 20:15:15.678 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251212181427_InitialCreate', N'8.0.20');
2025-12-12 20:47:17.360 +02:00 [INF] User profile is available. Using 'C:\Users\yvann\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-12-12 20:47:17.516 +02:00 [INF] Appointment Reminder Service started at "2025-12-12T18:47:17.5119964Z"
2025-12-12 20:47:18.909 +02:00 [INF] Now listening on: https://localhost:7146
2025-12-12 20:47:18.913 +02:00 [INF] Now listening on: http://localhost:5291
2025-12-12 20:47:19.399 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-12-12 20:47:19.402 +02:00 [INF] Hosting environment: Development
2025-12-12 20:47:19.404 +02:00 [INF] Content root path: C:\Users\yvann\Downloads\Dotnet_Web_Api\MediPredict\MediPredict
2025-12-12 20:47:22.050 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7146/swagger - null null
2025-12-12 20:47:22.662 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7146/swagger - 301 0 null 615.7365ms
2025-12-12 20:47:22.669 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7146/swagger/index.html - null null
2025-12-12 20:47:22.828 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7146/swagger/index.html - 200 null text/html;charset=utf-8 158.4617ms
2025-12-12 20:47:22.844 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7146/swagger/swagger-ui.css - null null
2025-12-12 20:47:22.844 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7146/swagger/swagger-ui-bundle.js - null null
2025-12-12 20:47:22.845 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7146/swagger/swagger-ui-standalone-preset.js - null null
2025-12-12 20:47:22.853 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7146/_framework/aspnetcore-browser-refresh.js - null null
2025-12-12 20:47:22.881 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7146/_framework/aspnetcore-browser-refresh.js - 200 16507 application/javascript; charset=utf-8 28.4239ms
2025-12-12 20:47:23.007 +02:00 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2025-12-12 20:47:23.012 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7146/swagger/swagger-ui.css - 200 152034 text/css 167.9324ms
2025-12-12 20:47:23.018 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7146/_vs/browserLink - null null
2025-12-12 20:47:23.150 +02:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2025-12-12 20:47:23.153 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7146/swagger/swagger-ui-standalone-preset.js - 200 230280 text/javascript 308.4683ms
2025-12-12 20:47:23.382 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7146/_vs/browserLink - 200 null text/javascript; charset=UTF-8 363.1335ms
2025-12-12 20:47:23.468 +02:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2025-12-12 20:47:23.471 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7146/swagger/swagger-ui-bundle.js - 200 1456926 text/javascript 626.4708ms
2025-12-12 20:47:23.843 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7146/swagger/v1/swagger.json - null null
2025-12-12 20:47:23.961 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7146/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 117.4985ms
2025-12-12 20:47:24.069 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7146/swagger/favicon-32x32.png - null null
2025-12-12 20:47:24.075 +02:00 [INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
2025-12-12 20:47:24.085 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7146/swagger/favicon-32x32.png - 200 628 image/png 16.0314ms
2025-12-12 20:47:48.055 +02:00 [INF] Checking for reminders to send at "2025-12-12T18:47:48.0552136Z"
2025-12-12 20:47:51.567 +02:00 [INF] Executed DbCommand (147ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[AppointmentDate], [a].[ConfirmationNumber], [a].[CreatedAt], [a].[Diagnosis], [a].[DoctorId], [a].[DurationMinutes], [a].[Notes], [a].[PatientId], [a].[ReasonForVisit], [a].[ScheduledDate], [a].[Status], [a].[SymptomEntryId], [a].[TreatmentPlan], [a].[UpdatedAt], [p].[Id], [p].[Allergies], [p].[BloodGroup], [p].[CreatedAt], [p].[EmergencyContact], [p].[EmergencyPhone], [p].[MedicalHistory], [p].[UpdatedAt], [p].[UserId], [a0].[Id], [a0].[Address], [a0].[CreatedAt], [a0].[DateOfBirth], [a0].[Email], [a0].[FirstName], [a0].[Gender], [a0].[IsActive], [a0].[LastLoginAt], [a0].[LastName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[ProfilePicture], [a0].[Role], [a0].[UserName], [d].[Id], [d].[AvailableDays], [d].[AvailableTimeEnd], [d].[AvailableTimeStart], [d].[Bio], [d].[ConsultationFee], [d].[CreatedAt], [d].[Experience], [d].[IsVerified], [d].[LicenseNumber], [d].[Qualifications], [d].[Specialization], [d].[UpdatedAt], [d].[UserId], [a1].[Id], [a1].[Address], [a1].[CreatedAt], [a1].[DateOfBirth], [a1].[Email], [a1].[FirstName], [a1].[Gender], [a1].[IsActive], [a1].[LastLoginAt], [a1].[LastName], [a1].[PasswordHash], [a1].[PhoneNumber], [a1].[ProfilePicture], [a1].[Role], [a1].[UserName], [n].[Id], [n].[AppointmentId], [n].[ConsultationId], [n].[CreatedAt], [n].[ErrorMessage], [n].[IsSent], [n].[MessageBody], [n].[RecipientEmail], [n].[RetryCount], [n].[SentAt], [n].[Subject], [n].[Type], [n].[UserId]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[Id]
INNER JOIN [AspNetUsers] AS [a0] ON [p].[UserId] = [a0].[Id]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[Id]
INNER JOIN [AspNetUsers] AS [a1] ON [d].[UserId] = [a1].[Id]
LEFT JOIN [NotificationLogs] AS [n] ON [a].[Id] = [n].[AppointmentId]
WHERE [a].[Status] = 1 AND [a].[AppointmentDate] > @__now_0
ORDER BY [a].[Id], [p].[Id], [a0].[Id], [d].[Id], [a1].[Id]
2025-12-12 20:47:51.618 +02:00 [INF] Found 0 scheduled appointments to evaluate
2025-12-12 20:53:33.846 +02:00 [INF] Application is shutting down...
2025-12-12 21:08:25.789 +02:00 [INF] User profile is available. Using 'C:\Users\yvann\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-12-12 21:08:25.877 +02:00 [INF] Appointment Reminder Service started at "2025-12-12T19:08:25.8727094Z"
2025-12-12 21:08:26.240 +02:00 [INF] Now listening on: https://localhost:7146
2025-12-12 21:08:26.248 +02:00 [INF] Now listening on: http://localhost:5291
2025-12-12 21:08:26.600 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-12-12 21:08:26.602 +02:00 [INF] Hosting environment: Development
2025-12-12 21:08:26.608 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7146/swagger/index.html - null null
2025-12-12 21:08:26.612 +02:00 [INF] Content root path: C:\Users\yvann\Downloads\Dotnet_Web_Api\MediPredict\MediPredict
2025-12-12 21:08:27.253 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7146/swagger/index.html - 200 null text/html;charset=utf-8 649.6612ms
2025-12-12 21:08:27.554 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7146/_framework/aspnetcore-browser-refresh.js - null null
2025-12-12 21:08:27.562 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7146/_vs/browserLink - null null
2025-12-12 21:08:27.587 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7146/_framework/aspnetcore-browser-refresh.js - 200 16507 application/javascript; charset=utf-8 32.3385ms
2025-12-12 21:08:27.663 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7146/_vs/browserLink - 200 null text/javascript; charset=UTF-8 100.8893ms
2025-12-12 21:08:28.268 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7146/swagger/v1/swagger.json - null null
2025-12-12 21:08:28.440 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7146/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 171.9462ms
2025-12-12 21:08:56.084 +02:00 [INF] Checking for reminders to send at "2025-12-12T19:08:56.0843297Z"
2025-12-12 21:08:59.167 +02:00 [INF] Executed DbCommand (183ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[AppointmentDate], [a].[ConfirmationNumber], [a].[CreatedAt], [a].[Diagnosis], [a].[DoctorId], [a].[DurationMinutes], [a].[Notes], [a].[PatientId], [a].[ReasonForVisit], [a].[ScheduledDate], [a].[Status], [a].[SymptomEntryId], [a].[TreatmentPlan], [a].[UpdatedAt], [p].[Id], [p].[Allergies], [p].[BloodGroup], [p].[CreatedAt], [p].[EmergencyContact], [p].[EmergencyPhone], [p].[MedicalHistory], [p].[UpdatedAt], [p].[UserId], [a0].[Id], [a0].[Address], [a0].[CreatedAt], [a0].[DateOfBirth], [a0].[Email], [a0].[FirstName], [a0].[Gender], [a0].[IsActive], [a0].[LastLoginAt], [a0].[LastName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[ProfilePicture], [a0].[Role], [a0].[UserName], [d].[Id], [d].[AvailableDays], [d].[AvailableTimeEnd], [d].[AvailableTimeStart], [d].[Bio], [d].[ConsultationFee], [d].[CreatedAt], [d].[Experience], [d].[IsVerified], [d].[LicenseNumber], [d].[Qualifications], [d].[Specialization], [d].[UpdatedAt], [d].[UserId], [a1].[Id], [a1].[Address], [a1].[CreatedAt], [a1].[DateOfBirth], [a1].[Email], [a1].[FirstName], [a1].[Gender], [a1].[IsActive], [a1].[LastLoginAt], [a1].[LastName], [a1].[PasswordHash], [a1].[PhoneNumber], [a1].[ProfilePicture], [a1].[Role], [a1].[UserName], [n].[Id], [n].[AppointmentId], [n].[ConsultationId], [n].[CreatedAt], [n].[ErrorMessage], [n].[IsSent], [n].[MessageBody], [n].[RecipientEmail], [n].[RetryCount], [n].[SentAt], [n].[Subject], [n].[Type], [n].[UserId]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[Id]
INNER JOIN [AspNetUsers] AS [a0] ON [p].[UserId] = [a0].[Id]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[Id]
INNER JOIN [AspNetUsers] AS [a1] ON [d].[UserId] = [a1].[Id]
LEFT JOIN [NotificationLogs] AS [n] ON [a].[Id] = [n].[AppointmentId]
WHERE [a].[Status] = 1 AND [a].[AppointmentDate] > @__now_0
ORDER BY [a].[Id], [p].[Id], [a0].[Id], [d].[Id], [a1].[Id]
2025-12-12 21:08:59.226 +02:00 [INF] Found 0 scheduled appointments to evaluate
2025-12-12 21:09:37.112 +02:00 [INF] Application is shutting down...
2025-12-12 23:04:56.529 +02:00 [INF] Executed DbCommand (231ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-12 23:04:57.076 +02:00 [INF] Executed DbCommand (304ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-12-12 23:04:57.079 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-12 23:04:57.080 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-12-12 23:04:58.552 +02:00 [INF] Executed DbCommand (1,408ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-12-12 23:04:58.599 +02:00 [INF] Applying migration '20251212210213_RenameAspNetUsersToUsers'.
2025-12-12 23:05:05.081 +02:00 [INF] Executed DbCommand (4,624ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251212210213_RenameAspNetUsersToUsers', N'8.0.20');
2025-12-12 23:35:01.473 +02:00 [INF] Executed DbCommand (49ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-12 23:35:01.816 +02:00 [INF] Executed DbCommand (73ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-12-12 23:35:01.820 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-12 23:35:01.822 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-12-12 23:35:01.918 +02:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-12-12 23:35:01.973 +02:00 [INF] Applying migration '20251212213425_AddPermissionBasedAccessControlAndRenameUsersTable'.
2025-12-12 23:35:03.869 +02:00 [INF] Executed DbCommand (1,679ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Doctors] DROP CONSTRAINT [FK_Doctors_AspNetUsers_UserId];
2025-12-12 23:35:03.956 +02:00 [INF] Executed DbCommand (86ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [NotificationLogs] DROP CONSTRAINT [FK_NotificationLogs_AspNetUsers_UserId];
2025-12-12 23:35:04.008 +02:00 [INF] Executed DbCommand (51ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Patients] DROP CONSTRAINT [FK_Patients_AspNetUsers_UserId];
2025-12-12 23:35:04.574 +02:00 [INF] Executed DbCommand (565ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [AspNetUsers] DROP CONSTRAINT [PK_AspNetUsers];
2025-12-12 23:35:04.658 +02:00 [INF] Executed DbCommand (84ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_AspNetUsers_Role] ON [AspNetUsers];
2025-12-12 23:35:05.225 +02:00 [INF] Executed DbCommand (566ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var0 sysname;
SELECT @var0 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[AspNetUsers]') AND [c].[name] = N'Role');
IF @var0 IS NOT NULL EXEC(N'ALTER TABLE [AspNetUsers] DROP CONSTRAINT [' + @var0 + '];');
ALTER TABLE [AspNetUsers] DROP COLUMN [Role];
2025-12-12 23:35:07.711 +02:00 [INF] Executed DbCommand (2,486ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
EXEC sp_rename N'[AspNetUsers]', N'Users';
2025-12-12 23:35:07.740 +02:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
EXEC sp_rename N'[Users].[IX_AspNetUsers_IsActive]', N'IX_Users_IsActive', N'INDEX';
2025-12-12 23:35:07.741 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
EXEC sp_rename N'[Users].[IX_AspNetUsers_Email]', N'IX_Users_Email', N'INDEX';
2025-12-12 23:35:07.802 +02:00 [INF] Executed DbCommand (60ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Users] ADD [RoleId] uniqueidentifier NOT NULL DEFAULT '00000000-0000-0000-0000-000000000000';
2025-12-12 23:35:07.844 +02:00 [INF] Executed DbCommand (42ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Users] ADD CONSTRAINT [PK_Users] PRIMARY KEY ([Id]);
2025-12-12 23:35:07.952 +02:00 [INF] Executed DbCommand (107ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Permissions] (
    [Id] uniqueidentifier NOT NULL,
    [Name] nvarchar(100) NOT NULL,
    [Description] nvarchar(200) NOT NULL,
    [Category] nvarchar(50) NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_Permissions] PRIMARY KEY ([Id])
);
2025-12-12 23:35:07.954 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Roles] (
    [Id] uniqueidentifier NOT NULL,
    [Name] nvarchar(50) NOT NULL,
    [Description] nvarchar(200) NOT NULL,
    [IsActive] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_Roles] PRIMARY KEY ([Id])
);
2025-12-12 23:35:08.047 +02:00 [INF] Executed DbCommand (93ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserPermissions] (
    [Id] uniqueidentifier NOT NULL,
    [UserId] uniqueidentifier NOT NULL,
    [PermissionId] uniqueidentifier NOT NULL,
    [AssignedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_UserPermissions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_UserPermissions_Permissions_PermissionId] FOREIGN KEY ([PermissionId]) REFERENCES [Permissions] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_UserPermissions_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-12-12 23:35:08.091 +02:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [RolePermissions] (
    [Id] uniqueidentifier NOT NULL,
    [RoleId] uniqueidentifier NOT NULL,
    [PermissionId] uniqueidentifier NOT NULL,
    [AssignedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_RolePermissions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_RolePermissions_Permissions_PermissionId] FOREIGN KEY ([PermissionId]) REFERENCES [Permissions] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_RolePermissions_Roles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [Roles] ([Id]) ON DELETE CASCADE
);
2025-12-12 23:35:08.133 +02:00 [INF] Executed DbCommand (42ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Users_RoleId] ON [Users] ([RoleId]);
2025-12-12 23:35:08.167 +02:00 [INF] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Permissions_Category] ON [Permissions] ([Category]);
2025-12-12 23:35:08.198 +02:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Permissions_Name] ON [Permissions] ([Name]);
2025-12-12 23:35:08.260 +02:00 [INF] Executed DbCommand (62ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_RolePermissions_PermissionId] ON [RolePermissions] ([PermissionId]);
2025-12-12 23:35:08.261 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_RolePermissions_RoleId_PermissionId] ON [RolePermissions] ([RoleId], [PermissionId]);
2025-12-12 23:35:08.272 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Roles_Name] ON [Roles] ([Name]);
2025-12-12 23:35:08.273 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserPermissions_PermissionId] ON [UserPermissions] ([PermissionId]);
2025-12-12 23:35:08.274 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_UserPermissions_UserId_PermissionId] ON [UserPermissions] ([UserId], [PermissionId]);
2025-12-12 23:35:08.305 +02:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Doctors] ADD CONSTRAINT [FK_Doctors_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE;
2025-12-12 23:35:08.309 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [NotificationLogs] ADD CONSTRAINT [FK_NotificationLogs_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE NO ACTION;
2025-12-12 23:35:08.391 +02:00 [INF] Executed DbCommand (82ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Patients] ADD CONSTRAINT [FK_Patients_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE;
2025-12-12 23:35:08.412 +02:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Users] ADD CONSTRAINT [FK_Users_Roles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [Roles] ([Id]) ON DELETE NO ACTION;
2025-12-12 23:35:08.463 +02:00 [INF] Executed DbCommand (51ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251212213425_AddPermissionBasedAccessControlAndRenameUsersTable', N'8.0.20');
